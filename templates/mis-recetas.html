{% extends 'base.html' %}
{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/mis-recetas.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/categorias.css') }}">
{% endblock %}
{% block title %}
Mi perfil
{% endblock %}

{% block content %}
<main>
    <div class="container">
        {% if misrecetas|length == 0 %}
        <div class="no-results">
          <i class='bx bx-dish'></i>
          <h3>No has creado ninguna receta.</h3>
          <p>Intenta una <a href="{{ url_for('nueva_receta') }}">crear una receta</a></p> 
        </div>
      {% else %}
        {% for receta in misrecetas %}
            <div class="card-receta">
                
                <div class="receta-opciones">
                    <button class="btn-opciones">
                        <i class='bx bx-dots-vertical-rounded'></i>
                    </button>
                    <div class="opciones-menu">
                        <a href="{{ url_for('editar_receta', idReceta=receta.idReceta) }}">Editar receta</a>
                        <button type="button" class="btn-eliminar-directo" onclick="abrirModalConfirmacion(event, '{{ receta.idReceta }}')">
                            Eliminar receta
                        </button>
                    </div>
                </div>
                <div class="receta-photo">
                    <div class="cont-photo">
                        <img src="/receta/obtenerImagen/{{receta.idReceta}}">
                    </div>
                </div>
                <div class="receta-info">
                    <h3>{{ receta.nombre }}</h3>
                    <p>{{ receta.descripcion }}</p>
                    
                </div>
                <div class="receta-calif">
                    {% set promedio = calif.obtener_promedio(receta.idReceta) %}
                    
                    {% for i in range(1, 6) %}
                        {% if i <= promedio %}
                            <i class="bx bxs-star"></i>
                        {% elif i - 0.5 == promedio %}
                            <i class="bx bxs-star-half"></i>
                        {% else %}
                            <i class="bx bx-star"></i>
                        {% endif %}
                    {% endfor %}
                    
                    <span class="numero-calif">({{ promedio }})</span>
                </div>

                <form action="/receta/{{receta.idReceta}}" method="get">
                    <div class="btnVer">
                        <button>Ver receta</button>
                    </div>
                </form>
            </div>
        {% endfor %}
        {% endif %}
    </div> <div id="modalConfirmar" class="modal-overlay">
        <div class="modal-contenido">
            <h3>Confirmar Eliminación</h3>
            <p>¿Estás seguro de que deseas eliminar esta receta? Esta acción no se puede deshacer.</p>
            <div class="modal-botones">
                <button type="button" id="btnCancelarModal" class="modal-btn modal-btn-cancelar">Cancelar</button>
                <button type="button" id="btnEliminarModal" class="modal-btn modal-btn-eliminar">Eliminar</button>
            </div>
        </div>
    </div>
    <script src="{{ url_for('static', filename='js/mis-recetas.js') }}"></script>
    </main>
{% endblock %}